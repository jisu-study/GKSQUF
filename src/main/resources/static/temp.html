<!DOCTYPE html>
<html lang="ko">
    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <title>여행 기록 - cost 부분만 뗀 임시 파일</title>
        <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-rbsA2VBKQhggwzxH7pPCaAqO46MgnOM80zW1RWuH61DGLwZJEdK2Kadq2F9CUG65" crossorigin="anonymous">
        <link href="style.css" rel="stylesheet">
    </head>
    <body>
        <table class="table">
            <tr>
                <th>사용 내역</th>
                <th>금액</th>
                <th class = "secret">Actions</th>
            </tr>
            <tr>
                <td><input type="text" id="details" placeholder="사용 내역을 적어주세요."/></td>
                <td><input type="number" id="amount" placeholder="금액을 숫자로 적어주세요."/></td>
            </tr>
            <tr>
                <td> 합계 </td>>
                <td id="sum"></td>
            </tr>
        </table>


        <script>

            document.addEventListener('DOMContentLoaded', function() {
                const detailsInput = document.getElementById('details');
                const amountInput = document.getElementById('amount');
                const sum = document.getElementById('sum');

                detailsInput.addEventListener('keypress', function(event) {
                    handleKeyPress(event, amountInput);
                });

                amountInput.addEventListener('keypress', function(event) {
                    handleKeyPress(event, null);
                });

                //initialize SUM
                //getSumFromDB();
                sum.textContent = '0';
            });

            function getSumFromDB(){
                var sum = document.getElementById('sum');

                //TODO : 디비에서 받아온 데이터여야함
                sum.textContent += 100;
            }

            function addRow() {
                var table = document.querySelector('table');
                var newRow = table.insertRow(table.rows.length - 2); // Insert before the last row (button row)

                var detailsInput = document.getElementById('details');
                var amountInput = document.getElementById('amount');

                var detailsValue = detailsInput.value;
                var amountValue = amountInput.value;

                var newCell1 = newRow.insertCell(0);
                var newCell2 = newRow.insertCell(1);
                var newCell3 = newRow.insertCell(2);

                newCell1.innerHTML = detailsValue;
                newCell2.innerHTML = amountValue;
                newCell3.innerHTML = '<button onclick="deleteRow(this)">-</button>';

                detailsInput.value = '';
                amountInput.value = '';
                detailsInput.focus();

                getSumFromDB();
            }

            function deleteRow(button) {
                var row = button.parentNode.parentNode;
                row.parentNode.removeChild(row);

                getSumFromDB();
            }

            function handleKeyPress(event, nextInputElement) {
                if (event.key === 'Enter') {
                    if (nextInputElement) {
                        nextInputElement.focus();
                    } else {
                        addRow();
                    }
                    event.preventDefault();
                }
            }
        </script>
    </body>
</html>